@model MusicPlataform.Client.Models.PlaylistReadDtoClient
@{
    ViewData["Title"] = Model.Name;
}
<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <input id="playlist-name" class="form-control form-control-lg bg-dark text-white border-0" value="@Model.Name" />
        <small class="text-muted">Playlist privada â€¢ <span id="track-count">@Model.TrackIds.Count()</span> canciones</small>
    </div>
    <div>
        <button id="btn-save-name" class="btn btn-outline-light btn-sm me-2">
            <i class="bi bi-save"></i> Guardar
        </button>
        <a href="@Url.Action("Index", "ArTrack")" class="btn btn-outline-light btn-sm">
            <i class="bi bi-arrow-left"></i> Volver
        </a>
    </div>
</div>


<div class="row">
    <div class="col-12">
        <div class="card bg-dark text-white">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>Canciones en esta lista</span>
            </div>
            <ul id="playlist-tracks" class="list-group list-group-flush bg-dark">
                <li class="list-group-item bg-dark text-muted">Cargando...</li>
            </ul>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const playlistId = @Model.Id;

        document.getElementById('btn-save-name')?.addEventListener('click', async () => {
            const newName = document.getElementById('playlist-name').value;
            const resp = await fetch(`/Playlists/UpdateName/${playlistId}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name: newName })
            });
                  if (resp.ok) {
            alert('Nombre actualizado');
            document.title = newName;

            // Actualizar el nombre en la barra lateral
            const link = document.querySelector(`#playlists-list a[data-playlist-id="${playlistId}"]`);
            if (link) {
                link.textContent = newName;
            }
        }
         else {
                alert('No se pudo actualizar el nombre');
            }
        });
    </script>
    <script src="~/js/playlist-view.js"></script>
}
